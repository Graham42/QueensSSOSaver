/* JQuery RC4 encryption/decryption
 * Copyright (c) 2009 by Tony Simek.
 * released under the terms of the Gnu Public License.
 * Email: tony.simek@gmail.com
 */
 (function(e){e.fn.rc4=function(t){var n={key:null,method:"encrypt",callback:null};var r=e.extend(n,t);if(e.fn.rc4.ctrlrInst==null){e.fn.rc4.ctrlrInst=new e.fn.rc4.ctrlr(r)}return this.each(function(){e.fn.rc4.ctrlrInst.settings=r;e.fn.rc4.ctrlrInst.container=this;e.fn.rc4.ctrlrInst.initialise(this)})};e.extend({hexEncode:function(e){var t="0123456789abcdef";var n=new Array;for(var r=0;r<256;r++){n[r]=t.charAt(r>>4)+t.charAt(r&15)}var i=new Array;for(var r=0;r<e.length;r++){i[r]=n[e.charCodeAt(r)]}return i.join("")},hexDecode:function(e){var t="0123456789abcdef";var n=new Array;for(var r=0;r<256;r++){n[t.charAt(r>>4)+t.charAt(r&15)]=String.fromCharCode(r)}if(!e.match(/^[a-f0-9]*$/i))return false;if(e.length%2)e="0"+e;var i=new Array;var s=0;for(var r=0;r<e.length;r+=2){i[s++]=n[e.substr(r,2)]}return i.join("")},rc4Encrypt:function(e,t){s=new Array;for(var n=0;n<256;n++){s[n]=n}var r=0;var i;for(n=0;n<256;n++){r=(r+s[n]+e.charCodeAt(n%e.length))%256;i=s[n];s[n]=s[r];s[r]=i}n=0;r=0;var o="";for(var u=0;u<t.length;u++){n=(n+1)%256;r=(r+s[n])%256;i=s[n];s[n]=s[r];s[r]=i;o+=String.fromCharCode(t.charCodeAt(u)^s[(s[n]+s[r])%256])}return o},rc4Decrypt:function(t,n){return e.rc4Encrypt(t,n)},rc4EncryptStr:function(t,n){return e.hexEncode(e.rc4Encrypt(n,unescape(encodeURIComponent(t))))},rc4DecryptStr:function(t,n){return decodeURIComponent(escape(e.rc4Decrypt(n,e.hexDecode(t))))}});e.rc4={};e.fn.rc4.ctrlrInst=null;e.fn.rc4.ctrlr=function(e){this.settings=e};var t=e.fn.rc4.ctrlr;t.prototype.initialise=function(){if(this.settings.key){if(this.settings.method){if(e.trim(this.settings.method.toUpperCase())=="ENCRYPT"){this.setObjectValue(e.hexEncode(e.rc4Encrypt(this.settings.key,this.getObjectValue())))}if(e.trim(this.settings.method.toUpperCase())=="DECRYPT"){this.setObjectValue(e.rc4Decrypt(this.settings.key,e.hexDecode(this.getObjectValue())))}}}};t.prototype.getObjectValue=function(){if(e.fn.rc4.ctrlrInst.container.innerHTML){return e.fn.rc4.ctrlrInst.container.innerHTML}if(e.fn.rc4.ctrlrInst.container.value){return e.fn.rc4.ctrlrInst.container.value}};t.prototype.setObjectValue=function(t){if(e.fn.rc4.ctrlrInst.container.innerHTML){e.fn.rc4.ctrlrInst.container.innerHTML=t}if(e.fn.rc4.ctrlrInst.container.value){e.fn.rc4.ctrlrInst.container.value=t}}})(jQuery)
 